# =============================================================================
# Django Boilerplate - Environment Variables
# =============================================================================
# Copy this file to .env and update values for your environment.
# NEVER commit .env files containing real secrets to version control.
# =============================================================================

# -----------------------------------------------------------------------------
# Django Core
# -----------------------------------------------------------------------------
# Secret key for cryptographic signing. Generate with:
# python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
DJANGO_SECRET_KEY=your-secret-key-here-change-in-production

# Set to false in production
DJANGO_DEBUG=true

# Comma-separated list of allowed hosts
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_DB=app
POSTGRES_USER=app
POSTGRES_PASSWORD=changeme
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# -----------------------------------------------------------------------------
# Redis (Cache, Sessions, Rate Limiting)
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379

# -----------------------------------------------------------------------------
# RabbitMQ (Celery Message Broker)
# -----------------------------------------------------------------------------
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest

# -----------------------------------------------------------------------------
# Keycloak OIDC (Optional - Enterprise SSO)
# -----------------------------------------------------------------------------
# Set to your Keycloak server URL
KEYCLOAK_SERVER_URL=http://keycloak:8080
KEYCLOAK_REALM=app
KEYCLOAK_CLIENT_ID=api
KEYCLOAK_AUDIENCE=api

# -----------------------------------------------------------------------------
# Cerbos (Authorization - Optional)
# -----------------------------------------------------------------------------
CERBOS_URL=http://cerbos:3592

# -----------------------------------------------------------------------------
# Local Authentication (Username/Password)
# -----------------------------------------------------------------------------
# Enable/disable local authentication (true/false)
LOCAL_AUTH_ENABLED=true

# JWT issuer identifier
LOCAL_AUTH_ISSUER=local

# Token time-to-live in seconds
LOCAL_AUTH_ACCESS_TOKEN_TTL=3600        # 1 hour
LOCAL_AUTH_REFRESH_TOKEN_TTL=604800     # 7 days

# Account security
LOCAL_AUTH_MAX_FAILED_ATTEMPTS=5        # Lock after 5 failed attempts
LOCAL_AUTH_LOCKOUT_DURATION=1800        # 30 minutes lockout

# RSA Keys for JWT signing (Required for local auth)
# Generate with: python -c "from api.local_jwt import generate_key_pair; priv, pub = generate_key_pair(); print('PRIVATE:'); print(priv); print('PUBLIC:'); print(pub)"
# Use multiline format with \n for line breaks
LOCAL_AUTH_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
LOCAL_AUTH_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"

# -----------------------------------------------------------------------------
# Email Verification & Password Reset
# -----------------------------------------------------------------------------
# Require email verification for new accounts (true/false)
EMAIL_VERIFICATION_REQUIRED=true

# Token expiration times in seconds
EMAIL_VERIFICATION_TOKEN_TTL=86400      # 24 hours
PASSWORD_RESET_TOKEN_TTL=3600           # 1 hour

# -----------------------------------------------------------------------------
# Multi-Factor Authentication (MFA/TOTP)
# -----------------------------------------------------------------------------
# Require MFA for all users (true/false)
MFA_REQUIRED=false

# Require MFA for admin users (true/false)
MFA_REQUIRED_FOR_ADMIN=false

# -----------------------------------------------------------------------------
# Social Authentication (OAuth 2.0)
# -----------------------------------------------------------------------------
# Google OAuth - Get credentials at https://console.cloud.google.com/
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# GitHub OAuth - Get credentials at https://github.com/settings/developers
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# OAuth callback URL (used by frontend)
OAUTH_REDIRECT_URL=http://localhost:3000/auth/callback

# -----------------------------------------------------------------------------
# Access Key Authentication (HMAC/S3-style)
# -----------------------------------------------------------------------------
# Timestamp tolerance for HMAC signature validation (in seconds)
AKSK_TIMESTAMP_TOLERANCE_SECONDS=300    # 5 minutes

# -----------------------------------------------------------------------------
# Field-Level Encryption (PII/PHI Protection)
# -----------------------------------------------------------------------------
# Fernet encryption keys for sensitive fields
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# Use comma-separated keys for key rotation (first key is primary)
FIELD_ENCRYPTION_KEYS=

# -----------------------------------------------------------------------------
# Audit Log Integrity
# -----------------------------------------------------------------------------
# HMAC key for signing audit log entries
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
AUDIT_SIGNING_KEY=

# Enable chain verification for tamper detection (true/false)
AUDIT_CHAIN_VERIFICATION_ENABLED=true

# PII policy: mask, hash, or store
AUDIT_PII_POLICY=mask

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# Format: <count>/<period> where period is second, minute, hour, or day
THROTTLE_RATE_ANON=100/hour
THROTTLE_RATE_USER=1000/hour

# -----------------------------------------------------------------------------
# Email Configuration
# -----------------------------------------------------------------------------
# SMTP backend (use console backend for development)
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend

# SMTP server settings
EMAIL_HOST=mailpit
EMAIL_PORT=1025
EMAIL_USE_TLS=false
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=
DEFAULT_FROM_EMAIL=noreply@example.com

# -----------------------------------------------------------------------------
# Storage (S3/MinIO)
# -----------------------------------------------------------------------------
# Set to true to use S3-compatible storage
USE_S3=false

# S3/MinIO credentials
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_S3_ENDPOINT_URL=http://minio:9000
AWS_STORAGE_BUCKET_NAME=uploads
AWS_S3_REGION_NAME=us-east-1

# -----------------------------------------------------------------------------
# Stripe Billing (Optional)
# -----------------------------------------------------------------------------
# Enable Stripe integration (true/false)
STRIPE_ENABLED=false

# Stripe API keys - Get at https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Product/Price IDs for subscription tiers
STRIPE_PRICE_ID_BASIC=price_...
STRIPE_PRICE_ID_PRO=price_...
STRIPE_PRICE_ID_ENTERPRISE=price_...

# Billing redirect URLs
STRIPE_SUCCESS_URL=http://localhost:3000/admin/billing/success
STRIPE_CANCEL_URL=http://localhost:3000/admin/billing

# -----------------------------------------------------------------------------
# Frontend URL
# -----------------------------------------------------------------------------
FRONTEND_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Observability (Optional)
# -----------------------------------------------------------------------------
# Sentry DSN for error tracking
SENTRY_DSN=

# OpenTelemetry endpoint for tracing
OTEL_EXPORTER_OTLP_ENDPOINT=
